@using Webdiyer.AspNetCore;
@model PagedList<LJH.VRTool.Users.Dto.UserDto>
@section styles{
    <link href="~/lib/krpano/hplus/css/plugins/blueimp/css/blueimp-gallery.min.css" rel="stylesheet" />
    <link href="~/lib/krpano/hplus/css/plugins/fancybox/fancybox.css" rel="stylesheet" />
    <style>
        .layui-tab-content {
            padding-left: 50px;
        }

        .file-option, .file-name {
            text-align: center
        }

        .upload-button-container {
            margin: 15px 0;
        }

        .add_newgroup {
            padding: 12px 5px;
            color: #293846;
        }

        .jstree-position {
            width: 180px;
            position: absolute
        }

        .tree-selected {
            background-color: #293846;
        }

        .tree-dl dl dd span {
            display: none;
        }

        .tree-dl dl:hover dd span {
            display: block;
            bottom: 22px;
            right: 6px;
            position: relative;
        }

        #tab-audio .file-box {
            width: 334px;
        }
    </style>
}
<div class="wrapper wrapper-content">
    <div class="tabs-container">
        <ul class="nav nav-tabs">
            <li class="active">
                <a data-toggle="tab" href="#tab-pano" aria-expanded="true"> 全景图片</a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#tab-picture" aria-expanded="false">图片</a>
            </li>
            <li class="">
                <a data-toggle="tab" href="#tab-audio" aria-expanded="false">音频</a>
            </li>
        </ul>
        <div class="tab-content">
            <div id="tab-pano" class="tab-pane active">
                <div id="tree" class="jstree jstree-2 jstree-default jstree-position">
                    <div class="add_newgroup" onclick="add_newGroup()">+ 新建分组</div>
                    <div class="tree-dl">
                        <dl class="tree-selected">
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>未分组(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>未分组(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>未分组(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                    </div>
                </div>
                <div class="animated fadeInRight" style="margin-left:210px">
                    <div class="upload-button-container">
                        <button type="button" class="layui-btn" id="pano">上传全景图</button>
                    </div>
                    <div>
                        @for (int i = 0; i < 18; i++)
                        {
                            <div class="file-box">
                                <div class="file">
                                    <a href="file_manager.html#">
                                        <span class="corner"></span>
                                        <div class="image">
                                            <img alt="image" class="img-responsive" src="http://www.zi-han.net/theme/hplus/img/p1.jpg" />
                                        </div>
                                        <div class="file-name">
                                            Italy street.jpg <br />
                                            <small>添加时间：2014-10-13</small>
                                        </div>
                                        <div class="file-option">
                                            <a href="#" onclick="preview()">预览</a>
                                            <a href="#" onclick="edit()">编辑</a>
                                            <a href="#" onclick="deleted()">删除</a>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="text-center" style="clear:both">
                    <nav aria-label="Page navigation">
                        @Html.Pager(Model, new PagerOptions
                   {
                       PageIndexParameterName = "pageIndex",
                       TagName = "ul",
                       CssClass = "pagination",
                       CurrentPagerItemTemplate = "<li class=\"page-item active\"><a  class=\"page-link\" href=\"javascript:void(0);\">{0}</a></li>",
                       DisabledPagerItemTemplate = "<li class=\"page-item disabled\"><a class=\"page-link\">{0}</a></li>",
                       PagerItemTemplate = "<li class=\"page-item\">{0}</li>",
                       Id = "bootstrappager"
                   })
                    </nav>
                </div>
            </div>
            <div id="tab-picture" class="tab-pane">
                <div id="tree" class="jstree jstree-2 jstree-default jstree-position">
                    <div class="add_newgroup" onclick="add_newGroup()">+ 新建分组</div>
                    <div class="tree-dl">
                        <dl class="tree-selected">
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>未分组(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>图片(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>图片(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                    </div>
                </div>
                <div class="animated fadeInRight" style="margin-left:210px">
                    <div class="upload-button-container">
                        <button type="button" class="layui-btn" id="pano">上传图片</button>
                    </div>
                    <div>
                        @for (int i = 0; i < 18; i++)
                        {
                            <div class="file-box">
                                <div class="file">
                                    <span class="corner"></span>
                                    <div class="image">
                                        <img alt="image" class="img-responsive" src="~/lib/krpano/hplus/img/p1.jpg" />
                                    </div>
                                    <div class="file-name">
                                        Italy street.jpg <br />
                                        <small>添加时间：2014-10-13</small>
                                    </div>
                                    <div class="file-option">
                                        <a onclick="preview()" class="fancybox" href="~/lib/krpano/hplus/img/p1.jpg" title="picname">预览</a>
                                        <a href="#" onclick="edit()">编辑</a>
                                        <a href="#" onclick="deleted()">删除</a>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="text-center" style="clear:both">
                    <nav aria-label="Page navigation">
                        @Html.Pager(Model, new PagerOptions
                   {
                       PageIndexParameterName = "pageIndex",
                       TagName = "ul",
                       CssClass = "pagination",
                       CurrentPagerItemTemplate = "<li class=\"page-item active\"><a  class=\"page-link\" href=\"javascript:void(0);\">{0}</a></li>",
                       DisabledPagerItemTemplate = "<li class=\"page-item disabled\"><a class=\"page-link\">{0}</a></li>",
                       PagerItemTemplate = "<li class=\"page-item\">{0}</li>",
                       Id = "bootstrappager"
                   })
                    </nav>
                </div>
            </div>
            <div id="tab-audio" class="tab-pane">
                <div id="tree" class="jstree jstree-2 jstree-default jstree-position">
                    <div class="add_newgroup" onclick="add_newGroup()">+ 新建分组</div>
                    <div class="tree-dl">
                        <dl class="tree-selected">
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>未分组(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>音乐(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                        <dl>
                            <dt onclick="selectGroup()">
                                <a class="jstree-anchor" href="#"><i class="jstree-icon jstree-themeicon"></i>音乐(5)</a>
                            </dt>
                            <dd>
                                <span class="pull-right" onclick="edit_newGroup()"><i class="fa fa-navicon"></i></span>
                            </dd>
                        </dl>
                    </div>
                </div>
                <div class="animated fadeInRight" style="margin-left:210px">
                    <div class="upload-button-container">
                        <button type="button" class="layui-btn" id="pano">上传音频</button>
                        <button type="button" class="layui-btn" id="pano" onclick="conver()">文字转语音</button>
                    </div>
                    <div>
                        @for (int i = 0; i < 12; i++)
                        {
                            <div class="file-box">
                                <div class="file">
                                    <a href="#">
                                        <span class="corner"></span>
                                        <div class="icon">
                                            <div class="player">
                                                <audio controls>
                                                    <source src="http://music.baidu.com/cms/app/muplayer/test_mp3/1.mp3" type="audio/mp3">
                                                </audio>
                                            </div>
                                        </div>
                                        <div class="file-name">
                                            Document_2014.doc <br />
                                            <small>添加时间：2014-10-13</small>
                                        </div>
                                        <div class="file-option">
                                            <a href="#" onclick="edit()">编辑</a>
                                            <a href="#" onclick="deleted()">删除</a>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="text-center" style="clear:both">
                    <nav aria-label="Page navigation">
                        @Html.Pager(Model, new PagerOptions
                   {
                       PageIndexParameterName = "pageIndex",
                       TagName = "ul",
                       CssClass = "pagination",
                       CurrentPagerItemTemplate = "<li class=\"page-item active\"><a  class=\"page-link\" href=\"javascript:void(0);\">{0}</a></li>",
                       DisabledPagerItemTemplate = "<li class=\"page-item disabled\"><a class=\"page-link\">{0}</a></li>",
                       PagerItemTemplate = "<li class=\"page-item\">{0}</li>",
                       Id = "bootstrappager"
                   })
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts
    {
    <script src="~/lib/krpano/hplus/js/plugins/blueimp/jquery.blueimp-gallery.min.js"></script>
    <script src="~/lib/krpano/hplus/js/plugins/fancybox/jquery.fancybox.js"></script>
    <script>
        layui.use('upload', function () {
            var $ = layui.jquery
                , upload = layui.upload;
            //普通图片上传
            var uploadInst = upload.render({
                elem: '#pano'
                , url: '/upload/'
                , before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo1').attr('src', result); //图片链接（base64）
                    });
                }
                , done: function (res) {
                    //如果上传失败
                    if (res.code > 0) {
                        return layer.msg('上传失败');
                    }
                    //上传成功
                }
                , error: function () {
                    //演示失败状态，并实现重传
                    var demoText = $('#demoText');
                    demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                    demoText.find('.demo-reload').on('click', function () {
                        uploadInst.upload();
                    });
                }
            });
            upload.render({
                elem: '#test5'
                , url: '/upload/'
                , accept: 'video' //视频
                , done: function (res) {
                    console.log(res)
                }
            });
            upload.render({
                elem: '#audio'
                , url: '/upload/'
                , accept: 'audio' //音频
                , done: function (res) {
                    console.log(res)
                }
            });
        });
        //添加新分组
        function add_newGroup() {
            layer.open({
            anim: 3,
            type: 2,
            title: '添加分组',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '600px'],
            content: '@Url.Action("Add", "Group")',
            btn: ['确认', '取消'],
            yes: function (index, layero) {
                var body = layer.getChildFrame('body', index);
                var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                iframeWin.save();
            },
            btn2: function(index, layero){
                  layer.close(index);
            }
          });
        };
        //编辑分组
        function edit_newGroup() {
            layer.open({
            anim: 3,
            type: 2,
            title: '编辑分组',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '600px'],
            content: '@Url.Action("Edit", "Group")',
            btn: ['确认', '删除分组'],
            yes: function (index, layero) {
                var body = layer.getChildFrame('body', index);
                var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                iframeWin.deleted();
            },
            btn2: function(index, layero){
                  layer.close(index);
            }
            });
        };
        //分组筛选
        function selectGroup() {
            $(".tree-dl dl").click(function () {
                $(this).addClass("tree-selected").siblings().removeClass("tree-selected");
            });
        };
        function preview() {
            $('.fancybox').fancybox({
                openEffect: 'none',
                closeEffect: 'none'
            });
        };
        function edit() {
            layer.open({
            anim: 3,
            type: 2,
            title: '编辑',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '600px'],
            content: '@Url.Action("Edit", "Source")',
            btn: ['确认', '取消'],
            yes: function (index, layero) {
                var body = layer.getChildFrame('body', index);
                var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                iframeWin.deleted();
            },
            btn2: function(index, layero){
                  layer.close(index);
            }
            });
        };
        function deleted() {
            swal({
                title: "您确定要删除这条信息吗",
                text: "删除后将无法恢复，请谨慎操作！",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "删除",
                closeOnConfirm: false
            }, function () {
                swal("删除成功！", "您已经永久删除了这条信息。", "success");
            });
        };
        //文字转语音
        function conver() {
            layer.open({
            anim: 3,
            type: 2,
            title: '文字转语音',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '600px'],
            content: '@Url.Action("Conver", "Source")',
            btn: ['确认', '取消'],
            yes: function (index, layero) {
                var body = layer.getChildFrame('body', index);
                var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                iframeWin.deleted();
            },
            btn2: function(index, layero){
                  layer.close(index);
            }
            });
        }
    </script>
}
