<link href="~/lib/krpano/hplus/js/plugins/layui/css/layui.css" rel="stylesheet" />
<style>
    .layui-form-checked[lay-skin=primary] i {
        border-color: #1E9FFF !important;
        background-color: #1E9FFF;
        color: #fff;
    }

    .layui-form-checkbox[lay-skin=primary]:hover i {
        border-color: #1E9FFF;
        color: #fff;
    }
</style>
@RenderSection("styles", required: false)
@RenderBody()
@RenderSection("scripts", required: false)
<script src="~/lib/krpano/hplus/js/plugins/layui/layui.js"></script>
<script src="~/lib/krpano/hplus/js/plugins/layui/layui.all.js"></script>
<script src="~/lib/krpano/hplus/js/plugins/layui/lay/mymodules/dtree.js"></script>
<script>
    var dtree = layui.dtree;
    layui.use(['form'], function () {
        var form = layui.form;
        //全选
        form.on('checkbox(allChoose)', function (data) {
            var child = $(data.elem).parents('table').find('tbody input[type="checkbox"][name=selectedIds]');
            child.each(function (index, item) {
                item.checked = data.elem.checked;
            });
            form.render('checkbox');
        });
        //用户是否激活
        form.on('switch(IsActive)', function () {
            var index = layer.msg('修改中，请稍候', { icon: 16, time: false, shade: 0.8 });
            var _this = $(this);
            var id = _this.attr("data-id");
            $.ajax({
                type: 'POST',
                url: "/Users/IsActive?Id=" + id,
                dataType: 'json',
                success: function (res) {
                    if (res.result.status === "ok") {
                        layer.close(index);
                        layer.msg("修改成功！");
                    }
                    else {
                        layer.msg('修改失败!', { icon: 2, time: 5000 });
                    }
                },
                error: function (data) {
                    layer.msg('请求出错!', { icon: 3, time: 5000 });
                }
            });
        });
    });
    var OnBegin = function () {
        var index = layer.load();
        layer.load(index);
    };
    var OnSuccess = function () {
        var index = layer.load();
        layer.close(index);
    };
</script>
