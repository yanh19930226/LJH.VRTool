@using Webdiyer.AspNetCore;
@model PagedList<LJH.VRTool.Users.Dto.UserDto>
@{
    ViewBag.Title = "VR全景管理";
}
<div class="wrapper wrapper-content">
    <div class="ibox-content">
        <form id="searchForm" asp-action="Index" asp-controller="Users" data-ajax="true" data-ajax-method="POST" data-ajax-mode="replace" data-ajax-update="#ajaxresult">
            <blockquote class="layui-elem-quote-ext">
                <div class="layui-inline">
                    <select class="form-control input-sm" name="account">
                        <option>选项 1</option>
                        <option>选项 2</option>
                        <option>选项 3</option>
                        <option>选项 4</option>
                    </select>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label-ext">日期范围:</label>
                    <div class="layui-input-inline" style="width: 120px;">
                        <input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'TimeMin\')||\'%y-%M-%d\'}' })" id="TimeMin" name="TimeMin" class="lay-input-ext lay-input-time-ext Wdate">
                    </div>
                    <div class="layui-input-inline" style="width: 120px;">
                        <input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'TimeMax\')}',maxDate:'%y-%M-%d' })" id="TimeMax" name="TimeMax" class="lay-input-ext lay-input-time-ext Wdate">
                    </div>
                </div>
                @if (IsGranted(LJH.VRTool.Authorization.PermissionNames.Pages_Users_SearchAct))
                {
                    <div class="layui-inline">
                        <div class="layui-input-inline">
                            <input type="text" id="KeyWord" name="KeyWord" placeholder="请输入关键字" class="lay-input-ext">
                        </div>
                        <a class="layui-btn-ext layui-btnnobg-ext " onclick="searchList()">
                            <i class="layui-icon layui-icon-search">
                            </i>查询
                        </a>
                    </div>
                }
                @if (IsGranted(LJH.VRTool.Authorization.PermissionNames.Pages_Users_CreateAct))
                {
                    <div class="layui-inline">
                        <a class="layui-btn-ext layui-btnnobg-ext J_menuItem" onclick="add()">
                            <i class="layui-icon layui-icon-add-circle-fine">
                            </i>添加
                        </a>
                    </div>
                }
                @if (IsGranted(LJH.VRTool.Authorization.PermissionNames.Pages_Users_BatchDeleteAct))
                {
                    <div class="layui-inline">
                        <a class="layui-btn-ext layui-btn-dangernobg-ext" onclick="batchdeleted()">
                            <i class="layui-icon layui-icon-delete">
                            </i>批量删除
                        </a>
                    </div>
                }
            </blockquote>
        </form>
        <div class="table-responsive animated fadeInRight layui-form" id="ajaxresult">
            <partial name="List" model="@Model" />
        </div>
    </div>
</div>
@section scripts
    {
    <script>
        function add(){
            var index=layer.open({
            type: 2,
            title: '添加VR全景',
            shadeClose: true,
            shade: 0.8,
            area: ['600px', '600px'],
            content: '@Url.Action("Add", "Panoram")',
            btn: ['确认', '取消'],
            yes: function (index, layero) {
                var body = layer.getChildFrame('body', index);
                var iframeWin = window[layero.find('iframe')[0]['name']]; //得到iframe页的窗口对象，执行iframe页的方法：iframeWin.method();
                iframeWin.save();
            },
            btn2: function(index, layero){
                  layer.close(index);
            }
            });
            layui.layer.full(index);
            //改变窗口大小时，重置弹窗的宽高，防止超出可视区域（如F12调出debug的操作）
            $(window).on("resize", function () {
                layui.layer.full(index);
            })
        };
        function edit() {
            window.open("/Edit.html");
        };
        function preview() {
           window.location.href = "@Url.Action("Preview", "Panoram")";
        };
        function deleted() {

        }
    </script>
}
