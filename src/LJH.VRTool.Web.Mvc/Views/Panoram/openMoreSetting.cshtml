@*<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief" style="margin: 10px 40px;">
        <ul class="layui-tab-title">
            <li class="layui-this"><i class="fa fa-user"></i>基本设置</li>
            <li><i class="fa fa-users"></i>用户角色</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show animated fadeInRight">
                <partial name="Basic" />
            </div>
            <div class="layui-tab-item animated fadeInRight">

            </div>
        </div>
    </div>*@



<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>基本设置</title>
    <link rel="stylesheet" href="/static/lib/mTips/mTips.css">

</head>
<style>
    html {
    }

    .info-setting {
        /* width: 900px; */
        display: flex;
    }

    .fengmian {
        -webkit-box-flex: 0;
        -ms-flex: 0 0 200px;
        flex: 0 0 200px;
        position: relative;
        height: 200px;
        margin-right: 20px;
        -webkit-box-shadow: 0 2px 10px 0 rgba(0,0,0,.5);
        box-shadow: 0 2px 10px 0 rgba(0,0,0,.5);
        background-color: #4b4b4b;
        border-radius: 5px;
        overflow: hidden;
        width: 200px
    }

    .active-tags .layui-btn {
        margin-left: 0px !important;
        margin-right: 10px;
    }

    .info-setting .layui-input {
        /* height: 22px !important; */
    }
</style>

<body>
    <link rel="stylesheet" type="text/css" href="/static/lib/layui/css/layui.css">

    <script type="text/javascript" src="/static/lib/jquery/1.9.1/jquery.min.js"></script>

    <script>
    document.addEventListener("error", function (e) {
    var elem = e.target;
    if (elem.tagName.toLowerCase() === 'img') {

        // elem.style.display="none";
        elem.src = '/static/images/bbb.png';
        // elem.onclick=function(){$(this).next('button').click();}
    }
  }, true);
    $(function(){
      $('img').each(function(){
        var thisImg = $(this);
        if(!thisImg.attr('src')){
          // thisImg.hide()
          thisImg.attr('src','/static/images/bbb.png');

        }
        thisImg.click(function(){
          thisImg.next('button').click();
        })
        thisImg.next('button').hide();
      })
    })

    function initSwitch(formEle,field,switch_val,form = null,pano_id = 266){

      if(form == null){
        if(typeof(layui.form) != 'undefined'){
          form = layui.form
        }else{
          return;
        }
      }

      var valset = {}
      valset[field] = switch_val

      form.val(''+formEle+'',valset)
      form.on('switch('+field+')', function(data){
          setSwitch.field = field
          setSwitch.id = pano_id

          if(data.elem.checked){
              setSwitch.value = 1
          }else{
              setSwitch.value = 0
          }
          setSwitch.submit();
      });
    }
    function initTableSwitch(table,formEle,field,switch_val,form = null,pano_id = 266){
      if(form == null){
        if(typeof(layui.form) != 'undefined'){
          form = layui.form
        }else{
          return;
        }
      }

      var valset = {}
      valset[field] = switch_val

      form.val(''+formEle+'',valset)
      form.on('switch('+field+')', function(data){

          setTableField.table = table
          setTableField.field = field
          setTableField.id = pano_id

          if(data.elem.checked){
              setTableField.value = 1
          }else{
              setTableField.value = 0
          }
          setTableField.submit();
      });
    }
    </script>

    <style>
              /* .layui-this a{
          background-color: #4E5465;;
        }

        .layui-this a:hover{
          background-color: #4E5465;;
        } */

              .layui-btn-normal {
                  background-color: #427afb;
              }


              .layui-form-onswitch {
                  border-color: #427afb;
                  background-color: #427afb;
              }
    </style>

    <script type="text/javascript" src="/static/lib/layui/layui.js"></script>
    <script src="/static/js/common.js"></script>
    <script src="/static/js/localDb.js"></script>
    <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
        <ul class="layui-tab-title left-nav">

            <li class=""><a href="/pano/panoeditmore/skinPanosetting/view_id/1882">基本设置</a></li>
            @*<li class=""><a href="/pano/panoeditmore/beforeGifWorksChoose/view_id/1882">加载动画</a></li>*@
            <!-- <li class=""><a href="/pano/panoeditmore/beforeGifWorks/view_id/1882">加载动画</a></li> -->
            @*<li class=""><a href="/pano/panoeditmore/skinStartImage/view_id/1882">开场海报</a></li>
            <li class=""><a href="/pano/panoeditmore/skinPanoLogo/view_id/1882">作品LOGO</a></li>
            <li class=""><a href="/pano/panoeditmore/skinPassword/view_id/1882">访问密码</a></li>
            <li class=""><a href="/pano/panoeditmore/wxShare/view_id/1882">微信分享</a></li>
            <li class=""><a href="/pano/panoeditmore/settingSeo/view_id/1882">SEO优化</a></li>
            <li class=""><a href="/pano/panoeditmore/skinautorotate/view_id/1882">自动旋转</a></li>*@
        </ul>

    </div>
    <script>
  $('.left-nav li').each(function(){
    var it = $(this);
    var href = it.find('a').attr('href');
    var patt = /skinpanosetting/i;

    if(patt.test(href)){
      it.addClass('layui-this')
    }
  })
    </script>

    <style>
        .layui-body {
            position: absolute;
            left: 0;
            right: 0;
            top: 52px;
            bottom: 0;
            z-index: 998;
            width: auto;
            overflow: hidden;
            overflow-y: hidden;
            overflow-y: auto;
            box-sizing: border-box;
        }
    </style>

    <script>

    </script>
    <script>

        // Array Remove - By John Resig (MIT Licensed)
        Array.prototype.remove = function(from, to) {
            var rest = this.slice((to || from) + 1 || this.length);
            this.length = from < 0 ? this.length + from : from;
            return this.push.apply(this, rest);
        };

        var tags = '';

        if(tags.length){

            var tags = tags.split(',')
        }else{
            tags = [];
        }

        var system_tags = [
                        '地面',
                        '空中',
                        '国外',
                        '5A景区',
                        '4A景区',
                        '春季',
                        '夏季',
                        '秋季',
                        '冬季',
                    ];

        var temp_tags_str = tags.join(',');

        var last_edit_time = Date.parse(new Date());

    </script>
    <div class="layui-body">
        <!-- 内容主体区域 -->
        <div style="padding: 15px;">
            <div class="layui-card">
                <div class="layui-card-header">基本设置</div>
                <div class="layui-card-body">
                    <div class="info-setting">
                        <div class="left-setting" style="width:220px">
                            <div class="fengmian" id="fengmian">
                                <img src="https://panoimg.720hot.com/1/47356/3789/thumb.jpg" id="panoPoster" alt="" style="width: 100%;">
                                <div style="z-index: 99999;margin-top: 17px;position: absolute;bottom: 0;left: 0;display: flex">
                                    <div id="upload-pano-poster" class="layui-btn layui-btn-sm layui-btn-normal">修改封面</div>
                                    <div style="color:#4b4b4b;margin-left: 20px">建议:500×500</div>
                                </div>
                            </div>
                        </div>
                        <div class="right-setting " style="width:400px">
                            <form action="/pano/panoeditmore/skinPanosettingsave" class="layui-form" method="post" lay-filter="pano-info">
                                <input type="hidden" name="pano_id" value="266">

                                <div class="layui-form-item">
                                    <div class="layui-input-inline">
                                        <input type="text" name="zpname" required lay-verify="required" placeholder="请输入标题"
                                               autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <div class="layui-form-item layui-form-text">
                                    <div class="layui-input-inline" style="width: 100%;">
                                        <textarea placeholder="请输入简介" name="short_introduce" class="layui-textarea"></textarea>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <div class="layui-input-inline">
                                        <select name="cate_id" lay-filter="cateid" lay-verify="required">
                                            <option value="1">景区</option>
                                            <option value="12">商业</option>
                                            <option value="10">家居</option>
                                            <option value="11">室内设计</option>
                                            <option value="8">房产</option>
                                            <option value="3">城市</option>
                                            <option value="4">学校</option>
                                            <option value="2">风光</option>
                                            <option value="5">乡村</option>
                                            <option value="7">其他</option>
                                        </select>
                                    </div>
                                    <div class="layui-input-inline">
                                        <input type="text" name="show_author" value=""
                                               placeholder="请输入作者" autocomplete="off" class="layui-input">
                                    </div>
                                </div>
                                <!-- <div class="layui-form-item">
                                    <div class="layui-input-inline">
                                        <input type="text" name="show_author" value=""
                                            placeholder="请输入作者" autocomplete="off" class="layui-input">
                                    </div>
                                    <button type="button " class="layui-btn layui-btn-normal" lay-submit lay-filter="author" id="set-author">
                                        确定
                                    </button>
                                    <button type="button " class="layui-btn layui-btn-danger author" lay-submit lay-filter="del-author">
                                        删除
                                    </button>
                                </div> -->
                                <input type="hidden" name="tags" value="">
                                <div class="layui-form-item layui-form-text">
                                    <div class="layui-input-inline biaoqiankuang">
                                        <button class="layui-btn layui-btn-normal add-tages" type="button">添加标签</button>
                                        <div class="active-tags">

                                        </div>
                                    </div>
                                </div>
                                <div class="layui-form-item layui-form-text  ">
                                    <button class="layui-btn layui-btn-normal">保存</button>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- <div class="layui-card">
                <div class="layui-card-header">标签管理</div>
                <div class="layui-card-body">
                    <button class="layui-btn layui-btn-normal add-tages">添加</button>
                    <hr>
                    <div class="active-tags">

                    </div>
                </div>
            </div> -->

            <div class="layui-card">
                <div class="layui-card-header">全局开关</div>
                <div class="layui-card-body">
                    <form action="" class="layui-form" lay-filter="*">

                        <div class="layui-form-item" style="display:flex;flex-wrap: wrap;">
                            <div style="display:inline-block" data-mtpis="显示/隐藏全景顶部的滚动字幕">
                                <label class="layui-form-label">滚动字幕</label>
                                <input type="checkbox" name="is_show_roll_title" lay-filter="is_show_roll_title" lay-skin="switch">
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏简介">
                                    <label class="layui-form-label">简介</label>
                                    <input type="checkbox" name="show_jianjie" lay-filter="show_jianjie" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="开启/关闭解说音乐">
                                    <label class="layui-form-label">解说音乐</label>
                                    <input type="checkbox" name="is_jieshuo_open" lay-filter="is_jieshuo_open" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="开启/关闭背景音乐">
                                    <label class="layui-form-label">背景音乐</label>
                                    <input type="checkbox" name="is_bg_music_open" lay-filter="is_bg_music_open" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="进入全景时是否显示开场图片">
                                    <label class="layui-form-label">开场图片</label>
                                    <input type="checkbox" name="start_image" lay-filter="start_image" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="开启/关闭全景访问密码">
                                    <label class="layui-form-label">访问密码</label>
                                    <input type="checkbox" name="visit_password" lay-filter="visit_password" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="开启/关闭打赏">
                                    <label class="layui-form-label">打赏</label>
                                    <input type="checkbox" name="reward" lay-filter="reward" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="开启/关闭抢红包	">
                                    <label class="layui-form-label">抢红包</label>
                                    <input type="checkbox" name="redpacket" lay-filter="redpacket" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏左下角导航">
                                    <label class="layui-form-label">左下角导航</label>
                                    <input type="checkbox" name="iconnav" lay-filter="iconnav" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="以小行星特效进入全景">
                                    <label class="layui-form-label">小行星开场</label>
                                    <input type="checkbox" name="littleplanetintro" lay-filter="littleplanetintro" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="进入全景后是否自动巡游">
                                    <label class="layui-form-label">自动巡游</label>
                                    <input type="checkbox" name="view_rotate" lay-filter="view_rotate" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏LOGO	">
                                    <label class="layui-form-label">logo显示</label>
                                    <input type="checkbox" name="is_logo_show" lay-filter="is_logo_show" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏作者名称">
                                    <label class="layui-form-label">作者名称</label>
                                    <input type="checkbox" name="is_show_author" lay-filter="is_show_author" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏访问量">
                                    <label class="layui-form-label">访问量</label>
                                    <input type="checkbox" name="is_visit_show" lay-filter="is_visit_show" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏全屏按钮">
                                    <label class="layui-form-label">全屏按钮</label>
                                    <input type="checkbox" name="sys_fullscreen" lay-filter="sys_fullscreen" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏右下角位置按钮">
                                    <label class="layui-form-label">作品位置</label>
                                    <input type="checkbox" name="pano_location" lay-filter="pano_location" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏控制按钮">
                                    <label class="layui-form-label">控制按钮</label>
                                    <input type="checkbox" name="control_bar" lay-filter="control_bar" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏右上角栏目导航">
                                    <label class="layui-form-label">栏目导航</label>
                                    <input type="checkbox" name="menunav" lay-filter="menunav" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏右下角企业名片">
                                    <label class="layui-form-label">企业名片</label>
                                    <input type="checkbox" name="business_card" lay-filter="business_card" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏场景说明">
                                    <label class="layui-form-label">场景说明</label>
                                    <input type="checkbox" name="pano_atricle" lay-filter="pano_atricle" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="显示/隐藏微信二维码">
                                    <label class="layui-form-label">微信二维码</label>
                                    <input type="checkbox" name="wx_qrcode" lay-filter="wx_qrcode" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="微信端右上角提醒收藏	">
                                    <label class="layui-form-label">引导收藏</label>
                                    <input type="checkbox" name="is_wx_collect" lay-filter="is_wx_collect" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="是否默认显示场景列表	">
                                    <label class="layui-form-label">场景列表</label>
                                    <input type="checkbox" name="is_auto_show_thumb_list" lay-filter="is_auto_show_thumb_list" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="是否显示右侧咨询按钮	">
                                    <label class="layui-form-label">客服咨询</label>
                                    <input type="checkbox" name="is_show_service" lay-filter="is_show_service" lay-skin="switch">
                                </div>
                            </div>
                            <div>
                                <div style="display:inline-block" data-mtpis="如果可用，是否默认开启重力感应	">
                                    <label class="layui-form-label">重力感应</label>
                                    <input type="checkbox" name="is_gyro_auto_on" lay-filter="is_gyro_auto_on" lay-skin="switch">
                                </div>
                            </div>

                        </div>
                </div>

                </form>
            </div>
        </div>



    </div>
    </div>
    <div class="layui-card edit-tags" style="display:none;padding: 2%;">
        系统推荐的标签
        <hr>
        <div class="system-tags">

        </div>

        <hr>
        <form action="" class="layui-form">
            <div class="layui-form-item">
                <div class="layui-input-inline">
                    <input type="text" name="my-tags" placeholder="输入标签,多个用逗号','隔开"
                           autocomplete="off" class="layui-input">
                </div>
                <button title="输入标签,多个用逗号','隔开" type="button" class="layui-btn layui-btn-normal add-my-tags">添加</button>

            </div>
        </form>
    </div>
    <script src="/static/lib/mTips/mTips.js"></script>
    <script type="text/javascript" src="/static/plupload/plupload.full.min.js"></script>
    <script type="text/javascript" src="/static/plupload/qiniu.js"></script>
    <script type="text/javascript" src="/static/js/upqiniu.js"></script>
    <script>

        //动态、静态 图片上传
        var uptoken_url = "/pano/plupload/get_token";
        var cdnhost = "https://panoimg.720hot.com";
        function set_upload_path(ret)
        {
            $.ajax({
                type: "POST",
                url: "/pano/plupload/get_key",
                data: {"act": ret,'dir':'pano'},
                dataType: 'json',
                success: function (result) {
                    //result = eval("(" + result + ")");
                    var input = '<input type="hidden" id="qn_' + ret + '" value="' + result.key + '" />';
                    $("body").append(input);
                }
            });
        }
        function FileUploaded(up, file, info)
        {
            var res = eval("(" + info + ")");
            //入库
            $.ajax({
                type: "POST",
                url: "/pano/panoeditmore/fileupload",
                data: {sourceLink: res.key},
                dataType: 'json',
                success: function (result) {
                    //如果上传失败
                    if (result.code > 0) {
                        return layer.msg(result.msg, {icon: 5});
                    }
                    //上传成功
                    if (result.code == 0) {

                        $.post(
                            '/pano/panoeditmore/setUpload',
                            {
                                key:result.data.key,
                                table:'pano',
                                id:'id',
                                value:266,
                                field:'thumb'
                            }
                            ,function(setResult){
                                layer.msg('上传成功')
                                $('#panoPoster').attr('src', result.data.path)
                            })

                    }
                }
            });
        }
        getQiniuUploader("fengmian", "upload-pano-poster", "site_data");



        layui.use(['form','layer','upload'], function () {
            var layer = layui.layer;
            var form = layui.form;
            var upload = layui.upload;

                            initSwitch('*','show_jianjie',1,form)
                            initSwitch('*','is_jieshuo_open',1,form)
                            initSwitch('*','is_bg_music_open',1,form)
                            initSwitch('*','start_image',1,form)
                            initSwitch('*','visit_password',1,form)
                            initSwitch('*','reward',0,form)
                            initSwitch('*','redpacket',0,form)
                            initSwitch('*','iconnav',1,form)
                            initSwitch('*','littleplanetintro',1,form)
                            initSwitch('*','view_rotate',1,form)
                            initSwitch('*','is_logo_show',1,form)
                            initSwitch('*','is_show_author',1,form)
                            initSwitch('*','is_visit_show',1,form)
                            initSwitch('*','sys_fullscreen',1,form)
                            initSwitch('*','pano_location',1,form)
                            initSwitch('*','control_bar',1,form)
                            initSwitch('*','menunav',1,form)
                            initSwitch('*','business_card',1,form)
                            initSwitch('*','pano_atricle',1,form)
                            initSwitch('*','wx_qrcode',1,form)
                            initSwitch('*','is_wx_collect',0,form)
                            initSwitch('*','is_auto_show_thumb_list',1,form)
                            initSwitch('*','is_show_service',1,form)
                            initSwitch('*','is_gyro_auto_on',1,form)

            initTableSwitch('pano','*','is_show_roll_title',1)
            form.val('pano-info',{
                cate_id:1,
                zpname:'ii',
            })

            // $('.info-setting').css('width',function(){return window.innerWidth*0.7})
            settleSize();


            var systemTagsBox = $('.system-tags');
            var activeTagsBox = $('.active-tags');
            renderSystemBox();

            // setInterval(()=>{

            //     var the_tags_str =tags.join(',');
            //     if(the_tags_str == temp_tags_str){

            //     }else{
            //         var nowtime = Date.parse(new Date());

            //         if((nowtime - last_edit_time) > 1000){

            //             setTableField.table = 'pano';
            //             setTableField.field = 'tags';
            //             setTableField.value = the_tags_str;
            //             setTableField.callback = function(){

            //             }
            //             setTableField.id = 266;
            //             setTableField.submit();
            //             temp_tags_str = the_tags_str
            //         }
            //     }
            // },800)




            // //执行实例
            // var uploadSiteLogo = upload.render({
            //     elem: '#upload-pano-poster' //绑定元素
            //         ,
            //     url: '/pano/panoedit/poster' //上传接口
            //         ,
            //     accept: 'images' //允许上传的文件类型
            //         ,
            //     size: 2000 //最大允许上传的文件大小
            //         ,
            //     field: 'pano_poster',
            //     data: {
            //         pano_id: 266            //     },
            //     done: function (res) {
            //         //上传完毕回调

            //         if (res.code == 200) {
            //             layer.msg('上传成功')
            //             $('#panoPoster').attr('src', '/data_1/pano/' + res.path)
            //         } else {
            //             layer.msg("上传失败")
            //         }
            //     },
            //     error: function () {
            //         //请求异常回调
            //         layer.msg('系统错误')
            //     }
            // });



            form.on('select(cateid)',function(data){
                console.log(data);

                $.ajax({
                    'url':'/pano/panoeditmore/getTags',
                    type:'post',
                    data:{cate_id:data.value}
                    ,success: function(result){
                        system_tags = result;
                        console.log(system_tags);

                        renderSystemBox();
                    }
                })
            })

            systemTagsBox.on('click','button',function(e){
                var it = $(e.currentTarget);

                if(!it.hasClass('layui-btn-primary')){
                    delTags(it.attr('name'))
                }else{
                    addTags(it.attr('name'));
                }

            })

            activeTagsBox.on('click','button',function(e){
                var it = $(e.currentTarget);
                delTags(it.text())
            })

            if(tags.length>1){
                renderActiveBox();
            }

            $('.add-my-tags').click(function(){
                var tags_str = $('input[name="my-tags"]').val();
                $('input[name="my-tags"]').val('');

                var my_tags = tags_str.split(',');

                $(my_tags).each(function(n,e){
                    if(e == ''){
                        return ;
                    }
                    addTags(e)

                    $.post('/pano/panoeditmore/addSelfTags',{name:e})
                })
            })

            $('.add-tages').click(function(){
                layer.open({
                    type:1,
                    title:'添加标签',
                    area:['100%'],
                    shade: 0,
                    anim: 2,
                    offset: 'b',
                    content:$('.edit-tags')
                })
            })

            // $('.biaoqiankuang').css('width',(window.innerWidth-$('.layui-side').width()-$('.left-setting').width())*0.7)
            $(window).resize(function(){
                // $('.biaoqiankuang').css('width',(window.innerWidth-$('.layui-side').width()-$('.left-setting').width())*0.7)
                settleSize();


            })

            function settleSize(){
                // $('.left-setting').css('width',function(){return (window.innerWidth-$('.layui-side').width())*0.3})
                $('.right-setting').css('width',function(){return (window.innerWidth-$('.layui-side').width())*0.6})
            }

            function addTags(e){
                if(e == ''){
                    return ;
                }
                if($.inArray(e,tags) == -1){
                    tags.push(e)
                    renderActiveBox()
                }
            }

            function delTags(e){

                if($.inArray(e,tags) != -1){
                    tags.remove(tags.indexOf(e))
                    renderActiveBox()
                }
            }

            function renderActiveBox(){
                last_edit_time = Date.parse(new Date());
                activeTagsBox.children().remove();
                systemTagsBox.find('button').addClass('layui-btn-primary')
                $(tags).each((n,e)=>{
                    activeTagsBox.append('<button class="layui-btn layui-btn-xs">'+e+'<i class="layui-icon layui-icon-close"></i></button>');
                    systemTagsBox.find('button[name="'+e+'"]').removeClass('layui-btn-primary')
                })
                var the_tags_str =tags.join(',');
                $('input[name="tags"]').val(the_tags_str);

            }

            function renderSystemBox(){
                systemTagsBox.find('button').remove();
                $(system_tags).each((n,e)=>{
                    systemTagsBox.append('<button class="layui-btn layui-btn-primary layui-btn-xs" name="'+e+'">'+e+'</button>');

                })
                $(tags).each((n,e)=>{
                    systemTagsBox.find('button[name="'+e+'"]').removeClass('layui-btn-primary')
                })
            }
        })
    </script>
</body>

</html>